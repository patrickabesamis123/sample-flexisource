!function(){"use strict";var e=angular.module("app"),o=$("body").data("base_url");e.config(["$routeProvider","$locationProvider",function(e,o){o.html5Mode(!1)}]),e.controller("VideoController",["GlobalConstant","fileUploadService","$scope","$window","$http","$cookies","$location",function(e,a,r,n,t,i,s){function d(){var e=(navigator.appVersion,navigator.userAgent);r.browserName=navigator.appName;var o,a,n,t=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10);-1!=(a=e.indexOf("Opera"))?(r.browserName="Opera",t=e.substring(a+6),-1!=(a=e.indexOf("Version"))&&(t=e.substring(a+8))):-1!=(a=e.indexOf("MSIE"))?(r.browserName="IE",t=e.substring(a+5)):-1!=(a=e.indexOf("Chrome"))?(r.browserName="Chrome",t=e.substring(a+7)):-1!=(a=e.indexOf("Safari"))?(r.browserName="Safari",t=e.substring(a+7),-1!=(a=e.indexOf("Version"))&&(t=e.substring(a+8))):-1!=(a=e.indexOf("Firefox"))?(r.browserName="Firefox",t=e.substring(a+8)):(o=e.lastIndexOf(" ")+1)<(a=e.lastIndexOf("/"))&&(r.browserName=e.substring(o,a),t=e.substring(a+1),browserName.toLowerCase()==browserName.toUpperCase()&&(r.browserName=navigator.appName)),-1!=(n=t.indexOf(";"))&&(t=t.substring(0,n)),-1!=(n=t.indexOf(" "))&&(t=t.substring(0,n)),i=parseInt(""+t,10),isNaN(i)&&(t=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),$("body").addClass(r.browserName+" "+r.browserName+"-"+i)}var p=n.location.pathname,l=p.split("/"),u=l[l.length-1];if("redo-video"!=u&&""!=u||(n.location.href=o),console.log(u),r.showSection2=!0,!(DetectRTC.hasMicrophone&&DetectRTC.hasWebcam||r.mobile_agent))return $("#pmvCameraModalNew .errorUpload").show(),$("#pmvCameraModalNew .modal-button-right-con").html('<p class="text-danger">Recording unavailable. see error below</p>'),0==DetectRTC.hasMicrophone&&$("#pmvCameraModalNew .errorUpload span").html('<p class="text-danger">Microphone not set</p>'),0==DetectRTC.hasWebcam&&$("#pmvCameraModalNew .errorUpload span").html('<p class="text-danger">Camera not set</p>'),isSafari&&$("#pmvCameraModalNew .errorUpload span").html('<p class="text-danger">Your browser not supported.</p>'),!1;r.stopVideo=function(){a.stopVideo(r)},r.recordVideo=function(){a.recordVideo(r)},r.recordVideoAgain=function(){r.buttonsHideShow(!1,!0,!0,!0,!0)},r.changeVideo=function(){a.changeVideo(r)},r.buttonsHideShow=function(e,o,a,n,t){r.record_btn=e,r.record_again_btn=o,r.stop_btn=a,r.save_btn=n,r.change_btn=t},r.startVideo=function(){d(),r.isSafari||"Safari"==r.browserName?alert("Oh oh looks like you're using Safari! Use Chrome or Firefox to record a video using your webcam."):a.startVideo(r)},r.ondragoverout_image=!1,r.ondragover_image=!0,document.dropVideoModalNew=function(e){e.preventDefault(),r.ondragoverout_image=!1,r.ondragover_image=!0,r.video_uploader("",e)},document.allowDrop=function(e){e.preventDefault(),r.ondragoverout_image=!0,r.ondragover_image=!1},document.leaveIt=function(e){r.ondragoverout_image=!1,r.ondragover_image=!0},$("#video_upload_modal_new").change(function(){r.video_uploader("video_upload_modal_new")}),r.video_uploader=function(e,o){console.log("uploading stuff"),a.video_upload(r,e,o,"redo_video",u)},r.saveVideo=function(){a.saveVideo(r,"redo_video",u)}}])}();